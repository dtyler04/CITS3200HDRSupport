{% extends "base.html" %}
{% block title %}Admin Dashboard{% endblock %}
{% block content %}
<h1>Admin Dashboard</h1>

<div class="row">
  <div class="col-lg-6">
    <div class="card p-3 mb-3">
      <h5>Create Message</h5>
      <form method="post" action="{{ url_for('admin_create_message') }}">
        {{ msg_form.hidden_tag() }}
        <div class="mb-2">{{ msg_form.title.label }}{{ msg_form.title(class_='form-control') }}</div>
        <div class="mb-2">{{ msg_form.message_content.label }}{{ msg_form.message_content(class_='form-control') }}</div>
        <div class="mb-2">
          <label>Schedule</label>
          <input type="datetime-local" name="scheduled_at" class="form-control">
        </div>
        <div class="mb-2">{{ msg_form.degree_type_target.label }}{{ msg_form.degree_type_target(class_='form-select') }}</div>
        <div class="mb-2">{{ msg_form.location_target.label }}{{ msg_form.location_target(class_='form-select') }}</div>
        <div class="mb-2">{{ msg_form.stage_target.label }}{{ msg_form.stage_target(class_='form-select') }}</div>
        <button class="btn btn-primary">{{ msg_form.submit.label.text }}</button>
      </form>
    </div>

    <div class="card p-3 mb-3">
      <h5>Create Reminder</h5>
      <form method="post" action="{{ url_for('admin_create_reminder') }}">
        {{ rem_form.hidden_tag() }}
        <div class="mb-2">{{ rem_form.title.label }}{{ rem_form.title(class_='form-control') }}</div>
        <div class="mb-2">{{ rem_form.content.label }}{{ rem_form.content(class_='form-control') }}</div>
        <div class="mb-2"><label>Schedule</label><input type="datetime-local" name="scheduled_at" class="form-control"></div>
        <div class="mb-2">{{ rem_form.degree_type_target.label }}{{ rem_form.degree_type_target(class_='form-select') }}</div>
        <div class="mb-2">{{ rem_form.location_target.label }}{{ rem_form.location_target(class_='form-select') }}</div>
        <div class="mb-2">{{ rem_form.stage_target.label }}{{ rem_form.stage_target(class_='form-select') }}</div>
        <button class="btn btn-primary">{{ rem_form.submit.label.text }}</button>
      </form>
    </div>
  </div>

  <div class="col-lg-6">
    <div class="card p-3 mb-3">
      <h5>Support Post</h5>
      <form method="post" action="{{ url_for('admin_create_post') }}" enctype="multipart/form-data">
        {{ post_form.hidden_tag() }}
        <div class="mb-2">{{ post_form.title.label }}{{ post_form.title(class_='form-control') }}</div>
        <div class="mb-2">{{ post_form.content.label }}{{ post_form.content(class_='form-control') }}</div>
        <div class="mb-2">{{ post_form.image.label }}{{ post_form.image(class_='form-control') }}</div>
        <button class="btn btn-primary">{{ post_form.submit.label.text }}</button>
      </form>
    </div>

    <div class="card p-3">
      <h5>Support Contacts</h5>
      <form method="post" action="{{ url_for('admin_create_contact') }}">
        {{ contact_form.hidden_tag() }}
        <div class="mb-2">{{ contact_form.service_type.label }}{{ contact_form.service_type(class_='form-control') }}</div>
        <div class="mb-2">{{ contact_form.name.label }}{{ contact_form.name(class_='form-control') }}</div>
        <div class="mb-2">{{ contact_form.info.label }}{{ contact_form.info(class_='form-control') }}</div>
        <button class="btn btn-primary">{{ contact_form.submit.label.text }}</button>
      </form>
    </div>
  </div>
</div>

<hr>
<h4>Existing messages & reminders</h4>
<div class="row">
  <div class="col-md-6">
    <h5>Messages</h5>
    <ul class="list-group">
      {% for m in messages %}
      <li class="list-group-item">
        <strong>{{ m.title }}</strong> — scheduled: {{ m.scheduled_at }} — targets: {{ m.degree_type_target or 'all' }}, {{ m.location_target or 'all' }}, {{ m.stage_target or 'all' }}
        <div class="small">{{ m.message_content }}</div>
      </li>
      {% endfor %}
    </ul>
  </div>
  <div class="col-md-6">
    <h5>Reminders</h5>
    <ul class="list-group">
      {% for r in reminders %}
      <li class="list-group-item">
        <strong>{{ r.title }}</strong> — at {{ r.scheduled_at }} — targets: {{ r.degree_type_target or 'all' }}, {{ r.location_target or 'all' }}, {{ r.stage_target or 'all' }}
        <div class="small">{{ r.content }}</div>
      </li>
      {% endfor %}
    </ul>
  </div>
</div>
<hr>
<h4>Support posts</h4>
<ul class="list-group">
  {% for p in posts %}
  <li class="list-group-item">
    <strong>{{ p.title }}</strong> — {{ p.created_at }}
    <div>{{ p.content }}</div>
    {% if p.image_filename %}
      <img src="{{ url_for('uploaded_file', filename=p.image_filename) }}" class="img-fluid mt-2" style="max-height:160px;">
    {% endif %}
  </li>
  {% endfor %}
</ul>

<h4 class="mt-4">Support contacts</h4>
<ul class="list-group">
  {% for c in contacts %}
  <li class="list-group-item"><strong>{{ c.service_type }}</strong>: {{ c.name }} — {{ c.info }}</li>
  {% endfor %}
</ul>

{% endblock %}